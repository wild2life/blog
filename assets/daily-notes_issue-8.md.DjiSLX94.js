import{_ as n,h as s,o as a,aa as p}from"./chunks/framework.CR3igpBK.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"daily-notes/issue-8.md","filePath":"daily-notes/issue-8.md","lastUpdated":null}'),e={name:"daily-notes/issue-8.md"},l=p(`<div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>  :::tip 原文地址</span></span>
<span class="line"><span>  [项目使用Vben模板，如何更新Vben | GitHub](https://github.com/wild2life/daily-notes/issues/8)</span></span>
<span class="line"><span>  :::</span></span>
<span class="line"><span>  import { execSync } from &#39;node:child_process&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const remoteVbenRepo = &#39;https://github.com/vbenjs/vue-vben-admin.git&#39;; // Vben 模板的远程仓库地址</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 获取目标分支，默认为 develop</span></span>
<span class="line"><span>const targetBranch = process.argv[2] || &#39;develop&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 执行 Git 命令</span></span>
<span class="line"><span>function executeCommand(command) {</span></span>
<span class="line"><span>  try {</span></span>
<span class="line"><span>    console.log(\`执行命令: \${command}\`);</span></span>
<span class="line"><span>    const output = execSync(command, {</span></span>
<span class="line"><span>      stdio: &#39;pipe&#39;,</span></span>
<span class="line"><span>    }); // 采用 pipe 方式捕获输出</span></span>
<span class="line"><span>    console.log(output.toString()); // 打印输出内容</span></span>
<span class="line"><span>    return output;</span></span>
<span class="line"><span>  } catch (error) {</span></span>
<span class="line"><span>    console.error(\`Git 命令执行失败: \${error.message}\`);</span></span>
<span class="line"><span>    console.error(error.stdout ? error.stdout.toString() : &#39;&#39;);</span></span>
<span class="line"><span>    console.error(error.stderr ? error.stderr.toString() : &#39;&#39;);</span></span>
<span class="line"><span>    process.exit(1);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function updateVbenTemplate() {</span></span>
<span class="line"><span>  // 1. 切换到 \`feature\` 分支</span></span>
<span class="line"><span>  console.log(\`切换到 \${targetBranch} 分支\`);</span></span>
<span class="line"><span>  executeCommand(\`git checkout \${targetBranch}\`);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  console.log(&#39;获取 Vben 模板最新内容...&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 2. 检查远程仓库是否存在 &#39;vben&#39; 获取 Vben 仓库内容</span></span>
<span class="line"><span>  console.log(&#39;检查是否已添加远程仓库 vben&#39;);</span></span>
<span class="line"><span>  try {</span></span>
<span class="line"><span>    executeCommand(&#39;git remote get-url vben&#39;, { stdio: &#39;ignore&#39; });</span></span>
<span class="line"><span>  } catch {</span></span>
<span class="line"><span>    console.log(&#39;没有找到远程仓库 vben，正在添加...&#39;);</span></span>
<span class="line"><span>    executeCommand(\`git remote add vben \${remoteVbenRepo}\`); // 添加远程 Vben 仓库</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  executeCommand(&#39;git fetch vben&#39;); // 拉取 Vben 仓库的内容</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 3. 使用 \`git merge --squash\` 合并 Vben 的内容</span></span>
<span class="line"><span>  console.log(&#39;合并 Vben 模板的内容...&#39;);</span></span>
<span class="line"><span>  const mergeResult = executeCommand(</span></span>
<span class="line"><span>    &#39;git merge --squash vben/main --allow-unrelated-histories&#39;,</span></span>
<span class="line"><span>  ); // 合并 Vben 模板</span></span>
<span class="line"><span>  if (!mergeResult) {</span></span>
<span class="line"><span>    console.log(&#39;合并失败，跳过此步骤，继续执行后续操作...&#39;);</span></span>
<span class="line"><span>    // 合并失败后继续执行，跳过可能的合并问题</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 保留 Vben 模板的其他文件（非 \`apps/web-antd\` 和 \`README.md\`）</span></span>
<span class="line"><span>  executeCommand(&#39;git checkout --theirs .&#39;); // 保留 Vben 模板的版本，解决其他冲突</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 4. 处理冲突：保留本地版本的 \`apps/web-antd\` 和 \`README.md\` 文件，保留 \`vben/main\` 版本的其他文件</span></span>
<span class="line"><span>  console.log(</span></span>
<span class="line"><span>    &#39;解决冲突：保留本地版本的 apps/web-antd 和 README.md，保留 Vben 版本的其他文件...&#39;,</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>  executeCommand(&#39;git checkout --ours README.md&#39;); // 保留本地 \`README.md\` 文件</span></span>
<span class="line"><span>  executeCommand(&#39;git checkout --ours apps/web-antd&#39;); // 保留本地 \`apps/web-antd\` 目录</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 5. 创建一个新的 commit</span></span>
<span class="line"><span>  console.log(&#39;创建合并的 commit...&#39;);</span></span>
<span class="line"><span>  executeCommand(&#39;git add .&#39;);</span></span>
<span class="line"><span>  executeCommand(&#39;git commit -m &quot;chore: update vben&quot; --no-verify&#39;);</span></span>
<span class="line"><span>  // 8. 推送更新到远程 \`feature\` 分支</span></span>
<span class="line"><span>  console.log(\`推送更新到远程 \${targetBranch} 分支...\`);</span></span>
<span class="line"><span>  executeCommand(\`git push origin \${targetBranch}\`);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  console.log(&#39;Vben 模板更新完成！&#39;);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 执行更新</span></span>
<span class="line"><span>updateVbenTemplate();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div>`,1),r=[l];function c(i,b,t,m,o,u){return a(),s("div",null,r)}const h=n(e,[["render",c]]);export{g as __pageData,h as default};
